[
  {
    "plugin_id": "dig",
    "name": "Dig",
    "description": "Scan DNS records.",
    "scan_level": 1,
    "oci_image": "tutum/dnsutils",
    "oci_arguments": [
      "dig",
      "+nocomments",
      "+noquestion",
      "+nostats",
      "@{nameserver}",
      "A",
      "{hostname}",
      "AAAA",
      "{hostname}",
      "CNAME",
      "{hostname}",
      "TXT",
      "{hostname}",
      "MX",
      "{hostname}"
    ]
  },
  {
    "plugin_id": "nmap-2",
    "name": "Nmap TCP 2",
    "description": "Defaults to top 250 TCP ports. Includes service detection.",
    "scan_level": 2,
    "oci_image": "instrumentisto/nmap",
    "oci_arguments": [
      "nmap",
      "--open",
      "--top-ports",
      "250",
      "-T4",
      "-Pn",
      "-r",
      "-v10",
      "-sV",
      "-sS",
      "-oX",
      "-",
      "{ipaddress|hostname}"
    ]
  },
  {
    "plugin_id": "citrix-bleed",
    "name": "CitrixBleed",
    "scan_level": 4,
    "oci_image": "ghcr.io/astral-sh/uv:python3.13-alpine",
    "oci_arguments": [
      "uv",
      "run",
      "--with",
      "requests",
      "https://raw.githubusercontent.com/RickGeex/CVE-2025-5777-CitrixBleed/refs/heads/main/CVE-2025-5777.py",
      "{hostname}"
    ]
  },
  {
    "plugin_id": "rpki-download",
    "name": "RPKI download",
    "scan_level": 1,
    "oci_image": "datacatering/duckdb:v1.3.2",
    "oci_arguments": [
      "/duckdb",
      "-c",
      "copy(select x.asn, x.prefix from (select unnest(roas) as x from read_json('https://console.rpki-client.org/vrps.json', maximum_object_size=100000000))) to '/dev/stdout' (format parquet);"
    ]
  },
  {
    "plugin_id": "bgp-download",
    "name": "BGP download",
    "scan_level": 1,
    "oci_image": "datacatering/duckdb:v1.3.2",
    "oci_arguments": [
      "/duckdb",
      "-c",
      "copy(select CIDR, ASN from read_json('https://bgp.tools/table.jsonl', maximum_object_size=100000000)) to '/dev/stdout' (format parquet);"
    ]
  },
  {
    "plugin_id": "nuclei-tls-version",
    "name": "Nuclei TLS Version",
    "scan_level": 2,
    "oci_image": "projectdiscovery/nuclei:v3.4.10",
    "oci_arguments": [
      "nuclei",
      "-t",
      "ssl/tls-version.yaml",
      "-j",
      "-u",
      "{hostname}"
    ]
  },
  {
    "plugin_id": "nuclei-expired-ssl",
    "name": "Nuclei Expired TLS Certificate",
    "scan_level": 2,
    "oci_image": "projectdiscovery/nuclei:v3.4.10",
    "oci_arguments": [
      "nuclei",
      "-t",
      "ssl/expired-ssl.yaml",
      "-j",
      "-u",
      "{hostname}"
    ]
  },
  {
    "plugin_id": "nuclei-tls-version-bulk",
    "name": "Nuclei TLS Version bulk",
    "scan_level": 2,
    "oci_image": "projectdiscovery/nuclei:v3.4.10",
    "oci_arguments": [
      "nuclei",
      "-t",
      "ssl/tls-version.yaml",
      "-j"
    ]
  },
  {
    "plugin_id": "masscan",
    "name": "Masscan",
    "scan_level": 2,
    "oci_image": "adarnimrod/masscan:latest",
    "oci_arguments": [
      "masscan",
      "--open",
      "-p",
      "80,443",
      "--max-rate",
      "100",
      "-oX",
      "-",
      "{ipaddress}"
    ]
  },
  {
    "plugin_id": "nuclei-tls-version-normalize",
    "name": "Nuclei Findings",
    "description": "Parses nuclei tls version data to create KATFindings.",
    "consumes": [
      "file:nuclei-tls-version",
      "file:nuclei-tls-version-bulk"
    ],
    "oci_image": "ghcr.io/minvws/openkat/plugins:latest",
    "oci_arguments": [
      "sh",
      "-c",
      "uv run cat.py {file} | jq '[.\"extracted-results\"[], \"Hostname|internet|\" +.host] | @tsv' -r | sed -e 's/tls12/KAT-TLS-1.2-SUPPORT/g' -e 's/tls13/KAT-TLS-1.3-SUPPORT/g' | grep KAT | uv run store_findings.py"
    ]
  }
]
