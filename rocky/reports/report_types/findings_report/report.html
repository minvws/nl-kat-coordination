{% load i18n %}

<div class="horizontal-scroll">
    {% if data %}
        {% include "partials/report_severity_totals.html" with data=data.summary %}

        <h2>{% translate "Findings found" %}</h2>
        <div class="horizontal-scroll">
            <table>
                <caption class="visually-hidden">{% translate "Other findings found:" %}</caption>
                <thead>
                    <tr>
                        <th scope="col">{% translate "Severity" %}</th>
                        <th scope="col">{% translate "Finding" %}</th>
                        <th scope="col">{% translate "Details" %}</th>
                    </tr>
                </thead>
                <tbody>
                    {% for info in data.finding_types %}
                        <tr>
                            <td>
                                <span class="{{ info.finding_type.risk_severity }}">{{ info.finding_type.risk_severity }}</span>
                            </td>
                            <td>{{ info.finding_type }}</td>
                            <td class="actions">
                                <button class="expando-button"
                                        data-icon-open-class="icon ti-chevron-down"
                                        data-icon-close-class="icon ti-chevron-up"
                                        data-close-label="{% translate "Close details" %}">
                                    {% translate "Open details" %}
                                </button>
                            </td>
                        </tr>
                        <tr class="expando-row">
                            <td colspan="5">
                                <h3>{{ info.finding_type }}</h3>
                                <h4>{% translate "Findings information" %}</h4>
                                <dl>
                                    <div>
                                        <dt>{% translate "Type" %}</dt>
                                        <dd>
                                            {{ info.finding_type.ooi_type }}
                                        </dd>
                                    </div>
                                    <div>
                                        <dt>{% translate "Finding" %}</dt>
                                        <dd>
                                            {{ info.finding_type.id }}
                                        </dd>
                                    </div>
                                    <div>
                                        <dt>{% translate "Risk level" %}</dt>
                                        <dd>
                                            {{ info.finding_type.risk_score }} / 10
                                        </dd>
                                    </div>
                                    <div>
                                        <dt>{% translate "Risk severity" %}</dt>
                                        <dd>
                                            {{ info.finding_type.risk_severity }}
                                        </dd>
                                    </div>
                                    <div>
                                        <dt>{% translate "Impact" %}</dt>
                                        <dd>
                                            {{ info.finding_type.impact }}
                                        </dd>
                                    </div>
                                    <div>
                                        <dt>{% translate "Description" %}</dt>
                                        <dd>
                                            {{ info.finding_type.description }}
                                        </dd>
                                    </div>
                                    <div>
                                        <dt>{% translate "Recommendation" %}</dt>
                                        <dd>
                                            {{ info.finding_type.recommendation }}
                                        </dd>
                                    </div>
                                </dl>
                                <h4>{% translate "Occurrences" %}</h4>
                                {% for occurrence in info.occurrences %}
                                    <div>
                                        <strong>{{ occurrence.ooi.human_readable }}</strong>
                                        <p>{{ occurrence.description }}</p>
                                    </div>
                                {% endfor %}
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% else %}
        <p>{% translate "No findings have been found." %}</p>
    {% endif %}
</div>
