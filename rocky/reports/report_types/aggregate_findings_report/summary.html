{% load i18n %}
{% load static %}

<section id="summary">
    <div>
        <h2>{% translate "Overview" %}</h2>
        <h3>{% translate "Summary" %}</h3>
        <p>
            <!-- Add date and time -->
            {% blocktranslate trimmed %}
                These are the findings of an OpenKAT analysis on {{ date }}.
                The following filters apply to these findings:
            {% endblocktranslate %}
        </p>
        <dl>
            {% for key, value in data.items %}
                <div>
                    <dt>{{ key }}</dt>
                    <dd>
                        {{ value }}
                    </dd>
                </div>
            {% endfor %}
        </dl>
        <h3>{% translate "Total" %}</h3>
        <table>
            <thead>
                <tr>
                    <th scope="col">{% translate "Level" %}</th>
                    <th scope="col">{% translate "Unique" %}</th>
                    <th scope="col">{% translate "Total occurrences" %}</th>
                </tr>
            </thead>
            <tbody>
                {% for level_name, level_sum in meta.total_by_severity.items %}
                    <tr>
                        <!-- Correct this data  -->
                        <td>{{ level_name }}</td>
                        <td>{{ meta.total_by_severity_per_finding_type[level_name] }}</td>
                        <td>{{ level_sum }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
        <h3>{% translate "Finding types" %}</h3>
        <table>
            <thead>
                <tr>
                    <th scope="col">{% translate "Risk level" %}</th>
                    <th scope="col">{% translate "Finding type" %}</th>
                    <th scope="col">{% translate "Occurrences" %}</th>
                </tr>
            </thead>
            <tbody>
                {% for finding_type_id, occurrence in findings_grouped.items()|sort(attribute='1.finding_type.risk_score', reverse=True) %}
                    <tr>
                        <!-- Correct this data  -->
                        <td>{{ occurrence.finding_type.risk_severity }}</td>
                        <td>{{ occurrence.finding_type.id }}</td>
                        <td>{{ occurrence.list|length }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</section>
