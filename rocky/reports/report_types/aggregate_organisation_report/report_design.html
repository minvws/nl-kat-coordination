{% load i18n %}
{% load static %}

<main id="main-content"
      tabindex="-1"
      class="sidemenu choose-report report"
      lang="nl">
    {% comment %} {% include "partials/report_sidemenu.html" %} {% endcomment %}
    {% include "partials/report_sidemenu.html" %}

    <article>
        <section class="introduction" id="introduction">
            <div>
                <div class="horizontal-view toolbar">
                    <h1>Mockup rapportage OpenKAT</h1>
                    <button>
                        Save report <span class="icon ti-chevron-down">Chevron down icoon</span>
                    </button>
                </div>
                <div>
                    <p>Dit is het OpenKAT rapport voor organisatie Organisatienaam.</p>
                    <div>
                        <p>
                            <strong>{% translate "Observed at:" %}</strong> {{ observed_at }} {{ TIME_ZONE }}
                        </p>
                        <p>
                            <strong>{% translate "Created by:" %}</strong> {{ organization_member.user.full_name }}
                        </p>
                    </div>
                </div>
            </div>
        </section>
        <section id="summary">
            <div>
                <h2>{% translate "Summary" %}</h2>
                <dl>
                    <div>
                        <dt>Recommendations</dt>
                        <dd>
                            3
                        </dd>
                    </div>
                    <div>
                        <dt>Critical vulnerabilities</dt>
                        <dd>
                            1
                        </dd>
                    </div>
                    <div>
                        <dt>Assets (IP/domains) scanned</dt>
                        <dd>
                            x
                        </dd>
                    </div>
                    <div>
                        <dt>Sector of organisation</dt>
                        <dd>
                            This is a sector definition to make it clear for the rest of the report what all the comparisons between percentages mean
                        </dd>
                    </div>
                    <div>
                        <dt>Basic security score compared to sector</dt>
                        <dd>
                            Score 80%, Sector: 77,5%
                        </dd>
                    </div>
                    <div>
                        <dt>Sector defined</dt>
                        <dd>
                            All healthcare organisations that use KAT for example.
                        </dd>
                    </div>
                    <div>
                        <dt>Lowest security score in organisation</dt>
                        <dd>
                            System specific
                        </dd>
                    </div>
                    <div>
                        <dt>Newly discovered items since last week, october 8th 2023</dt>
                        <dd>
                            <a href="">1 system</a>
                        </dd>
                    </div>
                    <div>
                        <dt>Terms in report</dt>
                        <dd>
                            DNS, SPF, CVE-2012-12345
                        </dd>
                    </div>
                </dl>
            </div>
        </section>
        <section id="term-overview">
            <div>
                <h2>Term overview</h2>
                <p>Onderstaand overzicht bevat definities van begrippen die in deze rapportage worden gebruikt.</p>
                <ul class="accordion">
                    <li>
                        <button id="definition-system" aria-expanded="false">Asset</button>
                        <div aria-labelledby="definition-system">
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit</p>
                        </div>
                    </li>
                    <li>
                        <button id="definition-system">System</button>
                        <div aria-labelledby="definition-system">
                            <p>
                                Multiple hostnames that resolve to one ip address where at least one of the hostnames or the ip address has a declared scan level that is at least L1.
                                Type systemen zijn webservers, mailservers, en nameservers (DNS).
                            </p>
                        </div>
                    </li>
                    <li>
                        <button id="definition-webserver">Webserver</button>
                        <div aria-labelledby="definition-webserver">
                            <p>
                                Voor webservers geldt hetzelfde maar http services gewoonlijk op porten 80 en 443. ((heeft dus extra uitleg ooit nodig welke services dat zijn))
                            </p>
                        </div>
                    </li>
                    <li>
                        <button id="definition-mailserver">Mailserver</button>
                        <div aria-labelledby="definition-mailserver">
                            <p>
                                Een mailserver wordt gedefinieerd als een server waar porten open staan waar ip services draaien die gebruikelijk zijn voor mail servers, gewoonlijk op porten 465, 25 en 995. ((heeft dus extra uitleg ooit nodig welke services dat zijn))
                            </p>
                        </div>
                    </li>
                    <li>
                        <button id="definition-nameserver">Nameserver</button>
                        <div aria-labelledby="definition-nameserver">
                            <p>
                                Een nameserver wordt gedefinieerd als een server waar porten open staan waar ip services draaien die gebruikelijk zijn voor dns servers, gewoonlijk op port 53. ((heeft dus extra uitleg ooit nodig welke services dat zijn))
                            </p>
                        </div>
                    </li>
                    <li>
                        <button id="example-accordion-ul-item-2">[V2] DISCOM server</button>
                        <div aria-labelledby="example-accordion-ul-item-2">
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
                        </div>
                    </li>
                </ul>
            </div>
        </section>
        <div class="chapter-numbers report-content">
            <section id="recommendations">
                <div>
                    <h2>Recommendations</h2>
                    <p>
                        Er zijn <i>n</i> kwetsbaarheden gevonden op <i>m</i> systemen. <i>O</i> systemen missen belangrijke basisbeveiligingsmaatregelen.
                    </p>
                    <ul>
                        <li>Update the web server of system IP (domain name)</li>
                        <li>Install the firewall in the OS of system IP (domain name)</li>
                        <li>
                            Check if <a href="">SPF [1]</a> is properly installed on all mail servers
                        </li>
                    </ul>
                </div>
            </section>
            <section id="asset-overview">
                <div>
                    <h2>Asset overview</h2>
                    <p>
                        Een overzicht van de handmatig gevrijwaarde gescande assets. <strong>Dikgedrukte</strong> assets zijn als startpunt genomen, niet dikgedrukte assets zijn door KAT zelf gevonden.
                    </p>
                    <div class="horizontal-scroll">
                        <table>
                            <caption class="visually-hidden">Overzicht Handmatig gevrijwaarde gescande assets:</caption>
                            <thead>
                                <tr>
                                    <th scope="col">IP address</th>
                                    <th scope="col">Domain</th>
                                    <th scope="col">System type</th>
                                    <th scope="col">Vulnerabilities</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>
                                        <strong>192.0.2.3</strong>
                                    </td>
                                    <td>example.com, sub.example.com</td>
                                    <td>Mail, web</td>
                                    <td>-</td>
                                </tr>
                                <tr>
                                    <td>
                                        <a href="">192.0.2.5</a>
                                        <span class="nowrap">
                                            <span class="new">New</span>
                                            <span class="de-emphasized">since Oct. 8, 2023</span>
                                        </span>
                                    </td>
                                    <td>sub.example.com</td>
                                    <td>Web</td>
                                    <td class="nowrap">
                                        <i class="icon cancelled"></i> Vulnerability found
                                    </td>
                                </tr>
                                <tr>
                                    <td>192.0.2.8</td>
                                    <td>-</td>
                                    <td>Nameserver (DNS)</td>
                                    <td>-</td>
                                </tr>
                                <tr>
                                    <td>198.51.100.125</td>
                                    <td>a.example.com, b.example.com, c.example.com, d.example.com, e.example.com, f.example.com</td>
                                    <td>Web, mail, dicom</td>
                                    <td>-</td>
                                </tr>
                                <tr>
                                    <td>2001:db8:ffff:ffff:ffff:ffff:ffff:ffff</td>
                                    <td>ipv6.example.com</td>
                                    <td>Web</td>
                                    <td>-</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
            <section id="open-ports">
                <div>
                    <h2>Open ports</h2>
                    <p>
                        Overzicht van gevonden open poorten zien. <strong>Dikgedrukte</strong> open poorten zijn gevonden door directe scans die de organisatie uitvoert via KAT. Overige open poorten zijn daar buiten aangetroffen door KAT zelf. Scans met dezelfde domeinen, poorten en IPs zijn samengevoegd.
                    </p>
                    <div class="horizontal-scroll">
                        <table>
                            <caption class="visually-hidden">Overzicht Handmatig gevrijwaarde gescande assets:</caption>
                            <thead>
                                <tr>
                                    <th scope="col">IP address</th>
                                    <th scope="col">Open port</th>
                                    <th scope="col">Domain</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>192.0.2.3</td>
                                    <td>
                                        80, 443, <strong><span class="visually-hidden">(startpunt)</span>5885</strong>
                                    </td>
                                    <td>example.com, sub.example.com</td>
                                </tr>
                                <tr>
                                    <td>192.0.2.4</td>
                                    <td>
                                        80, 443, <strong><span class="visually-hidden">(startpunt)</span>5885</strong>
                                    </td>
                                    <td>example.com, sub.example.com</td>
                                </tr>
                                <tr>
                                    <td>192.0.2.5</td>
                                    <td>
                                        5-25, <strong><span class="visually-hidden">(startpunt)</span>1200</strong>, 5000-5005
                                    </td>
                                    <td>-</td>
                                </tr>
                                <tr>
                                    <td>198.51.100.125</td>
                                    <td>
                                        1, 3, 5, 7, 9, 11, 14, 19, 21, 23, 25, 27, 29, 31, 33, 36, <strong><span class="visually-hidden">(startpunt)</span>41</strong>, 51, 61, 71, 73, 75, 81, 85, 91, 95, 101, 105, 110, 120, 130, 140, 150, 160, 170, 180
                                    </td>
                                    <td>a.example.com, b.example.com, c.example.com, d.example.com, e.example.com, f.example.com</td>
                                </tr>
                                <tr>
                                    <td>2001:db8:ffff:ffff:ffff:ffff:ffff:ffff</td>
                                    <td>
                                        <strong><span class="visually-hidden">(startpunt)</span>112</strong>
                                    </td>
                                    <td>ipv6.example.com</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
            <section id="ipv6">
                <div>
                    <h2>IPv6</h2>
                    <p>[Uitleg IPv6 en belang ervan] Waarom moet elk domein aan IPv4 en IPv6 voldoen.</p>
                    <div class="horizontal-scroll">
                        <table>
                            <caption class="visually-hidden">Basisvoorbeeld tabel:</caption>
                            <thead>
                                <tr>
                                    <th scope="col">Domain</th>
                                    <th scope="col">System type</th>
                                    <th scope="col">IPv6</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>example.com</td>
                                    <td>Mail</td>
                                    <td>
                                        <span class="icon incomplete">IPv6 mist</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td>sub.example.com</td>
                                    <td>Mail, web</td>
                                    <td>
                                        <span class="icon incomplete">IPv6 mist</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td>a.example.com</td>
                                    <td>Mail, web</td>
                                    <td>
                                        <span class="icon incomplete">IPv6 mist</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td>b.example.com</td>
                                    <td>Mail, web</td>
                                    <td>
                                        <span class="icon incomplete">IPv6 mist</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td>c.example.com</td>
                                    <td>Mail, web</td>
                                    <td>
                                        <span class="icon incomplete">IPv6 mist</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td>d.example.com</td>
                                    <td>Mail, web</td>
                                    <td>
                                        <span class="icon incomplete">IPv6 mist</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td>e.example.com</td>
                                    <td>Mail, web</td>
                                    <td>
                                        <span class="icon incomplete">IPv6 mist</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td>f.example.com</td>
                                    <td>Mail, web</td>
                                    <td>
                                        <span class="icon incomplete">IPv6 mist</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td>ipv6.example.com</td>
                                    <td>Web</td>
                                    <td>
                                        <span class="icon positive">IPv6 mist</span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
            <section id="basic-security">
                <div>
                    <h2>Basic security</h2>
                    <p>
                        In dit hoofstuk wordt eerst een tabel compliency checks getoond en vervolgens per onderdeel de compliency issues uitgelicht. Bij elk van deze onderdelen zijn twee percentages te zien, waarvan de één aangeeft hoe goed de basisbeveilging op orde is (hoger is beter) en de ander hoe goed dit bij andere gescande organisaties in de sector is (mediaan).
                    </p>
                </div>
                <div>
                    <h3>Overzicht van de basisbeveiligingsstatus</h3>
                    <p>
                        Deze tabel geeft een overzicht van de basisbeveiligingsstatus van de bekende assets. In principe moeten alle waardes in deze tabel groen kleuren.
                    </p>
                    <div class="horizontal-scroll">
                        <table>
                            <caption class="visually-hidden">Overzicht Handmatig gevrijwaarde gescande assets:</caption>
                            <thead>
                                <tr>
                                    <th scope="col">System type</th>
                                    <th scope="col">IPv6</th>
                                    <th scope="col">Safe connections</th>
                                    <th scope="col">System specific</th>
                                    <th scope="col">RPKI</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>E-mailserver</td>
                                    <td>
                                        <i class="icon positive">Positief icoon</i> 6/6
                                    </td>
                                    <td>
                                        <i class="icon positive">Positief icoon</i> 6/6
                                    </td>
                                    <td>
                                        <i class="icon positive">Positief icoon</i> 6/6
                                    </td>
                                    <td>
                                        <i class="icon positive">Positief icoon</i> 6/6
                                    </td>
                                </tr>
                                <tr>
                                    <td>Web server</td>
                                    <td>
                                        <i class="icon incomplete">Negatief icoon</i> 4/8
                                    </td>
                                    <td>
                                        <i class="icon incomplete">Negatief icoon</i> 6/8
                                    </td>
                                    <td>
                                        <i class="icon incomplete">Negatief icoon</i> 3/8
                                    </td>
                                    <td>
                                        <i class="icon positive">Positief icoon</i> 8/8
                                    </td>
                                </tr>
                                <tr>
                                    <td>Name server</td>
                                    <td>
                                        <i class="icon incomplete">Negatief icoon</i> 0/2
                                    </td>
                                    <td>
                                        <i class="icon incomplete">Negatief icoon</i> 0/2
                                    </td>
                                    <td>
                                        <i class="icon positive">Positief icoon</i> 2/2
                                    </td>
                                    <td>
                                        <i class="icon positive">Positief icoon</i> 2/2
                                    </td>
                                </tr>
                                <tr>
                                    <td>Other</td>
                                    <td>
                                        <i class="icon positive">Positief icoon</i> 1/1
                                    </td>
                                    <td>
                                        <i class="icon incomplete">Negatief icoon</i> 0/1
                                    </td>
                                    <td>
                                        <i class="icon positive">Positief icoon</i> 1/1
                                    </td>
                                    <td>
                                        <i class="icon positive">Positief icoon</i> 1/1
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div>
                    <h3>Safe connections</h3>
                    <p>
                        <strong><span class="tag critical">Critical</span> <span>Critical</span> Score: 80%, Sector: 90%</strong>
                    </p>
                    <p>
                        [Uitleg context van safe connections: wat betekent het als een systeem er niet voldoen? Waarom is dit ‘critical’?]
                    </p>
                    <div>
                        <h4>E-emailserver</h4>
                        <p>
                            Er zijn geen problemen aangetroffen bij de mailservers op het gebied van Safe Connections. In deze tabel is te zien welke checks er zijn uitgevoerd.
                        </p>
                        <div class="horizontal-scroll">
                            <table>
                                <caption class="visually-hidden">Overzicht Handmatig gevrijwaarde gescande assets:</caption>
                                <thead>
                                    <tr>
                                        <th scope="col">Check</th>
                                        <th scope="col">Compliancy</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>
                                            <a href="">DANE [3]</a>
                                        </td>
                                        <td>
                                            <i class="icon positive">Positief icoon</i> 6/6 mailservers complient
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <a href="">Lorem Ipsum 2</a>
                                        </td>
                                        <td>
                                            <i class="icon positive">Positief icoon</i> 6/6 mailservers complient
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <a href="">Lorem Ipsum 3</a>
                                        </td>
                                        <td>
                                            <i class="icon positive">Positief icoon</i> 6/6 mailservers complient
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <a href="">Lorem Ipsum 5</a>
                                        </td>
                                        <td>
                                            <i class="icon positive">Positief icoon</i> 6/6 mailservers complient
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <a href="">Lorem Ipsum 6</a>
                                        </td>
                                        <td>
                                            <i class="icon positive">Positief icoon</i> 6/6 mailservers complient
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div>
                        <h4>Web server</h4>
                        <p>
                            In de tabel is te zien welke checks er zijn uitgevoerd. Daaropvolgend de compliancy issues, weergegeven per webserver.
                        </p>
                        <div class="horizontal-scroll">
                            <table>
                                <caption class="visually-hidden">Overzicht Handmatig gevrijwaarde gescande assets:</caption>
                                <thead>
                                    <tr>
                                        <th scope="col">Check</th>
                                        <th scope="col">Compliancy</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>
                                            <a href="">Lorem Ipsum 3</a>
                                        </td>
                                        <td>
                                            <i class="icon positive">Positief icoon</i>8/8 webservers complient
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <a href="">Lorem Ipsum 4</a>
                                        </td>
                                        <td>
                                            <i class="icon positive">Positief icoon</i> 8/8 webservers complient
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <a href="">Lorem Ipsum 5</a>
                                        </td>
                                        <td>
                                            <i class="icon positive">Positief icoon</i> 8/8 webservers complient
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <a href="">Veilige ciphers check</a>
                                        </td>
                                        <td>
                                            <i class="icon positive">Positief icoon</i> 7/8 webservers complient
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <a href="">HSTS policy check</a>
                                        </td>
                                        <td>
                                            <i class="icon positive">Positief icoon</i> 7/8 webservers complient
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <a href="">Lorem Ipsum 1</a>
                                        </td>
                                        <td>
                                            <i class="icon positive">Positief icoon</i> 5/8 webservers complient
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <a href="">Lorem Ipsum 2</a>
                                        </td>
                                        <td>
                                            <i class="icon positive">Positief icoon</i> 6/8 webservers complient
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <h5>192.0.2.5 (sub.example.com)</h5>
                        <p>Lorem ipsum dolor set amet.</p>
                    </div>
                </div>
            </section>
            <section id="vulnerabilities">
                <div>
                    <h2>{% translate "Vulnerabilities" %}</h2>
                    <p>{% translate "Vulnerabilities found are grouped per system." %}</p>
                    {% for input_ooi, vulnerabilities in data.vulnerabilities.items %}
                        <h3>{{ input_ooi }}</h3>
                        <p>
                            <strong>{{ vulnerabilities.summary.total_findings }}</strong> {% translate "vulnerabilities on this system" %}
                        </p>
                        {% include "vulnerability_report/report.html" with data=vulnerabilities %}

                    {% endfor %}
                </div>
            </section>
        </div>
    </article>
</main>
