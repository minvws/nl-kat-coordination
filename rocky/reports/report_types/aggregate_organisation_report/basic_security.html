{% load i18n %}

<h2>{% translate "Basic security" %}</h2>
<p>
    {% blocktranslate trimmed %}
        In this chapter, first a table of compliance checks is displayed, followed by a
        detailed examination of compliance issues for each component.
        For each of these components, two percentages are provided: one indicating the
        level of basic security in place (higher is better), and the other showing
        how well this compares to other scanned organizations in the sector (median).
    {% endblocktranslate %}
</p>
<h3>{% translate "Overview of the basic security status" %}</h3>
<p>
    {% blocktranslate trimmed %}
        This table provides an overview of the basic security status of the known assets.
        Basic security in order. In principle, all values in this table should be checked off.
    {% endblocktranslate %}
</p>
<div class="horizontal-scroll">
    <table>
        <caption class="visually-hidden">{% translate "IPV6 overview:" %}</caption>
        <thead>
            <tr>
                <th scope="col">{% translate "System type" %}</th>
                <th scope="col">{% translate "Safe connections" %}</th>
                <th scope="col">{% translate "System Specific" %}</th>
                <th scope="col">{% translate "RPKI" %}</th>
            </tr>
        </thead>
        <tbody>
            {% for service, compliance in data.basic_security.summary.items %}
                <tr>
                    <td>{{ service }} {% translate "server" %} ({{ data.services|get_item:service|length }})</td>
                    <td>
                        {% if compliance.safe_connections.number_of_compliant != compliance.safe_connections.total %}
                            <span class="icon incomplete"></span>
                        {% else %}
                            <span class="icon positive"></span>
                        {% endif %}
                        {{ compliance.safe_connections.number_of_compliant }}/{{ compliance.safe_connections.total }}
                    </td>
                    <td>
                        {% if compliance.system_specific.number_of_compliant != compliance.system_specific.total %}
                            <span class="icon incomplete"></span>
                        {% else %}
                            <span class="icon positive"></span>
                        {% endif %}
                        {{ compliance.system_specific.number_of_compliant }}/{{ compliance.system_specific.total }}
                    </td>
                    <td>
                        {% if compliance.rpki.number_of_compliant != compliance.rpki.total %}
                            <span class="icon incomplete"></span>
                        {% else %}
                            <span class="icon positive"></span>
                        {% endif %}
                        {{ compliance.rpki.number_of_compliant }}/{{ compliance.rpki.total }}
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
