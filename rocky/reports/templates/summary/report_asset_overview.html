{% load i18n %}

<section id="asset-overview">
    <div>
        <h2>{% translate "Asset overview" %}</h2>
        <h3>{% translate "Selected objects" %}</h3>
        <p>
            {% blocktranslate trimmed %}
                The objects listed in the table below were used to generate this report.
                For each object in the table it additionally shows the clearance level and whether or not the object was
                added by a user ('Declared') or indirectly identified through another service or system ('Inherited').
            {% endblocktranslate %}
        </p>
        {% include "summary/ooi_selection.html" %}

        <h3>{% translate "Selected Report Types" %}</h3>
        <p>
            {% blocktranslate trimmed %}
                The table below shows which reports were chosen to generate this report,
                including a report description.
            {% endblocktranslate %}
        </p>
        <table>
            <caption class="visually-hidden">{% translate "Selected Report Types" %}</caption>
            <thead>
                <tr>
                    <th>{% translate "Report type" %}</th>
                    <th>{% translate "Description" %}</th>
                </tr>
            </thead>
            <tbody>
                {% for report_type in report_types %}
                    <tr>
                        <td>{{ report_type.name }}</td>
                        <td>{{ report_type.description }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
        <h3>{% translate "Selected Plugins for scans" %}</h3>
        <p>
            {% blocktranslate trimmed %}
                The table below shows which plugins were enabled, required or optional for the selected reports.
                It also shows the required clearance level and description of the plugin.
            {% endblocktranslate %}
        </p>
        <table>
            <caption class="visually-hidden">{% translate "Selected Plugins for scans" %}</caption>
            <thead>
                <tr>
                    <th>{% translate "Plugin options" %}</th>
                    <th>{% translate "Plugin name" %}</th>
                    <th>{% translate "Plugin scan level" %}</th>
                    <th>{% translate "Plugin type" %}</th>
                    <th>{% translate "Plugin description" %}</th>
                </tr>
            </thead>
            <tbody>
                {% if plugins.required or plugins.optional %}
                    {% for option, plugins in plugins.items %}
                        {% for plugin in plugins %}
                            <tr>
                                <td>{{ option }}</td>
                                <td>{{ plugin.name }}</td>
                                <td>
                                    {% include "partials/scan_level_indicator.html" with value=plugin.scan_level.value custom_class="left" %}

                                </td>
                                <td>
                                    <span class="label-plugin-type {{ plugin.type }}">{{ plugin.type|title }}</span>
                                </td>
                                <td>{{ plugin.description }}</td>
                            </tr>
                        {% endfor %}
                    {% endfor %}
                {% else %}
                    <tr>
                        <td>-</td>
                        <td>-</td>
                        <td>-</td>
                        <td>-</td>
                        <td>-</td>
                    </tr>
                {% endif %}
            </tbody>
        </table>
    </div>
</section>
