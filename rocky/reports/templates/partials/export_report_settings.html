{% load i18n %}
{% load static %}
{% load report_extra %}
{% load ooi_extra %}
{% load compress %}

<section>
    <div>
        {% if selected_report_types %}
            <h2>{% translate "Report schedule" %}</h2>
            <p>
                {% blocktranslate trimmed %}
                    When scheduling your report, you have two options. You can either choose to generate it just once now,
                    or set it to run automatically at regular intervals, like daily, weekly,
                    or monthly. If you need the report just for a single occasion, select the one-time option.
                {% endblocktranslate %}
            </p>
            <form id="generate_report" class="inline" method="post" action="{{ next }}">
                {% csrf_token %}
                {% include "forms/report_form_fields.html" %}
                {% include "partials/form/fieldset.html" with fields=report_schedule_form_start_date fieldset_parent_class="column-2" %}

                <div>
                    <h2>{% translate "Report name" %}</h2>
                    <p>
                        {% blocktranslate trimmed %}
                            Define a custom name format for your report(s). This format will be applied to all generated
                            (sub)reports.
                        {% endblocktranslate %}
                    </p>
                    <p>
                        {% blocktranslate trimmed %}
                            To make the report names more descriptive, you can include placeholders for the
                            object name, the report type and/or the reference date. For subreports and reports over a single object,
                            use the placeholder "${ooi}" for the object name, "${report_type}" for the report type and use a
                            <a href="https://strftime.org/" target="_blank" rel="noopener">Python strftime code</a> for the reference
                            date. For reports over multiple objects, use "${oois_count}" for the number of objects in the report.
                        {% endblocktranslate %}
                    </p>
                    <p>
                        {% blocktranslate trimmed %}
                            For example, the format "${report_type} for ${ooi} at %x" could generate:
                            "DNS Report for example.com at 01/01/25".
                        {% endblocktranslate %}
                    </p>
                </div>
                <fieldset>
                    <div>
                        <label for="parent_report_name_format">{% translate "Report name format" %}</label>
                        <input type="text"
                               id="parent_report_name_format"
                               name="parent_report_name_format"
                               value="{{ initial_report_names.0 }}">
                    </div>
                </fieldset>
                {% if initial_report_names.1 %}
                    <fieldset>
                        <div>
                            <label for="subreport_name_format">{% translate "Subreports name format" %}</label>
                            <input type="text"
                                   id="subreport_name_format"
                                   name="subreport_name_format"
                                   value="{{ initial_report_names.1 }}">
                        </div>
                    </fieldset>
                {% endif %}
                <button type="submit">
                    {% translate "Generate report" %}<span class="icon ti-chevron-right" aria-hidden="true"></span>
                </button>
            </form>
        {% else %}
            {% include "partials/return_button.html" with btn_text="Go back" %}

        {% endif %}
    </div>
</section>
{% block html_at_end_body %}
    <script src="{% static "js/renameReports.js" %}" nonce="{{ request.csp_nonce }}" type="module"></script>
    <script src="{% static "js/autoSubmit.js" %}" nonce="{{ request.csp_nonce }}" type="module"></script>
{% endblock html_at_end_body %}
