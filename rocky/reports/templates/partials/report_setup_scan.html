{% load i18n %}
{% load static %}

<section>
    <div>
        <h1>{% translate "Configuration" %}</h1>
        <p class="emphasized">{% translate "Set up the required plugins for this report." %}</p>
        {% if selected_oois and selected_report_types %}
            <a href="{{ previous }}" class="button ghost">
                <span class="icon ti-chevron-left"></span>{% translate "Change selection" %}
            </a>
            <h2>{% translate "Plugins" %}</h2>
            <p>
                <strong>{% translate "KAT will be able to generate a full report when all the required and suggested boefjes are enabled." %}</strong>
            </p>
            <p>
                {% translate "If you choose not to give a plugin permission to run, the data that plugin would collect or produce will be left out of the report which will then be generated based on the available data collected by the enabled plugins." %}
            </p>
            {% include "partials/plugin_overview_table.html" %}

            <h3>{% translate "Required plugins" %}</h3>
            <p>{% translate "This report type requires the following plugins to be enabled:" %}</p>
            {% if all_plugins_enabled.required %}
                <p>{% translate "Good job! All required plugins are enabled." %}</p>
            {% else %}
                <div class="column-4 tiles plugins images-cover">
                    {% for required_plugin in plugins.required %}
                        {% include "partials/plugin_tile.html" with plugin=required_plugin %}

                    {% endfor %}
                </div>
            {% endif %}
            <h3>{% translate "Suggested plugins" %}</h3>
            <p>
                {% translate "This report requires at least one of the following plugins to be enabled to generate the report:" %}
            </p>
            {% if all_plugins_enabled.optional %}
                <p>{% translate "Good job! All suggested plugins are enabled" %}</p>
            {% else %}
                <div class="column-4 tiles plugins images-cover">
                    {% for optional_plugin in plugins.optional %}
                        {% if optional_plugin not in plugins.required %}
                            {% include "partials/plugin_tile.html" with plugin=optional_plugin form_id="generate_report" %}

                        {% endif %}
                    {% endfor %}
                </div>
            {% endif %}
            <form id="generate_report" class="inline" method="get" action="{{ next }}">
                {% include "forms/report_form_fields.html" %}

                {% for report_type in selected_report_types %}
                    <input type="hidden" name="report_type" value={{ report_type }}>
                {% endfor %}
                <button type="submit">
                    {% translate "Generate report" %}<span class="icon ti-chevron-right"></span>
                </button>
            </form>
        {% else %}
            <a class="button ghost" href="{{ previous }}">
                <span class="icon ti-chevron-left"></span>{% translate "Go back" %}
            </a>
        {% endif %}
    </div>
</section>
