{% extends "layouts/base.html" %}

{% load i18n %}
{% load static %}

{% block content %}
    {% include "header.html" %}

    <main id="main-content" tabindex="-1" class="choose-report">
        <section>
            <div>
                <h1>{% translate "Choose report types" %}</h1>
                <p>
                    {% blocktranslate trimmed %}
                        Various types of reports, such as DNS reports and TLS reports, are essential for identifying
                        vulnerabilities in different aspects of a system's security. DNS reports focus on domain name
                        system configuration and potential weaknesses, while TLS reports assess the security of data
                        encryption and transmission protocols, helping organizations pinpoint areas where security
                        improvements are needed.
                    {% endblocktranslate %}
                </p>
                <h2>
                    {% blocktranslate trimmed count counter=oois|length %}
                        Selected object
                    {% plural %}
                        Selected objects
                    {% endblocktranslate %}
                </h2>
                <table>
                    <thead>
                        <tr>
                            <th>{% translate "Object" %}</th>
                            <th>{% translate "Type" %}</th>
                            <th>{% translate "Clearance level" %}</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{ oois }}
                        {% for ooi in oois %}
                            <tr>
                                <td>{{ ooi.primary_key }}</td>
                                <td>{{ ooi.object_type }}</td>
                                <td>
                                    {% include "partials/scan_level_indicator.html" with value=ooi.scan_profile.level.value %}

                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
                <a href="{% url 'report_oois_selection' organization.code %}?{{ request.GET.urlencode }}"
                   class="button ghost">
                    <span class="icon ti-chevron-left"></span>{% translate "Change selection" %}
                </a>
                <h2>{% translate "Available report types" %} ({{ report_types|length }})</h2>
                <p>{% translate "All report types that are available for your selection." %}</p>
                <a class="toggle-all" data-toggle-target="report_type">{% translate "Toggle all report types" %}</a>
                <form class="inline"
                      method="get"
                      action="{% url 'report_setup_scan' organization.code %}">
                    <div class="column-4 tiles">
                        {% include "partials/report_types_tiles.html" with report_types=report_types %}

                    </div>
                    {% for ooi in oois %}<input type="hidden" name="ooi" value={{ ooi }}>{% endfor %}
                    <button type="submit">
                        {% translate "Continue with selection" %}<span class="icon ti-chevron-right"></span>
                    </button>
                </form>
            </div>
        </section>
    </main>
{% endblock content %}
{% block html_at_end_body %}
    {{ block.super }}
    <script src="{% static "/js/checkboxToggler.js" %}" nonce="{{ request.csp_nonce }}"></script>
{% endblock html_at_end_body %}
